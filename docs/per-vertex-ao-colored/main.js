!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=25)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(28);e.regl=r(),e.propBinder=function(t){return function(e){return t.prop(e)}}},function(t,e){t.exports=window},function(t,e){var n=9007199254740991,r="[object Arguments]",o="[object Function]",i="[object GeneratorFunction]",c=Object.prototype,u=c.hasOwnProperty,a=c.toString,s=c.propertyIsEnumerable;t.exports=function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&function(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}(t.length)&&!function(t){var e=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}(t)?a.call(t):"";return e==o||e==i}(t)}(t)}(t)&&u.call(t,"callee")&&(!s.call(t,"callee")||a.call(t)==r)}},function(t,e){var n="[object Function]",r=/^\[object .+?Constructor\]$/;function o(t){return!!t&&"object"==typeof t}var i,c,u,a=Object.prototype,s=Function.prototype.toString,f=a.hasOwnProperty,l=a.toString,p=RegExp("^"+s.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),v=(i=Array,c="isArray",function(t){return null!=t&&(function(t){return function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}(t)&&l.call(t)==n}(t)?p.test(s.call(t)):o(t)&&r.test(t))}(u=null==i?void 0:i[c])?u:void 0),h=9007199254740991;var d=v||function(t){return o(t)&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=h}(t.length)&&"[object Array]"==l.call(t)};t.exports=d},function(t,e){var n="Expected a function",r=Math.max;t.exports=function(t,e){if("function"!=typeof t)throw new TypeError(n);return e=r(void 0===e?t.length-1:+e||0,0),function(){for(var n=arguments,o=-1,i=r(n.length-e,0),c=Array(i);++o<i;)c[o]=n[e+o];switch(e){case 0:return t.call(this,c);case 1:return t.call(this,n[0],c);case 2:return t.call(this,n[0],n[1],c)}var u=Array(e+1);for(o=-1;++o<e;)u[o]=n[o];return u[e]=c,t.apply(this,u)}}},function(t,e,n){var r=n(2),o=n(3),i=/^\d+$/,c=Object.prototype.hasOwnProperty,u=9007199254740991;function a(t,e){return t="number"==typeof t||i.test(t)?+t:-1,e=null==e?u:e,t>-1&&t%1==0&&t<e}t.exports=function(t){if(null==t)return[];var e,n;n=typeof(e=t),(!e||"object"!=n&&"function"!=n)&&(t=Object(t));var i=t.length;i=i&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=u}(i)&&(o(t)||r(t))&&i||0;for(var s=t.constructor,f=-1,l="function"==typeof s&&s.prototype===t,p=Array(i),v=i>0;++f<i;)p[f]=f+"";for(var h in t)v&&a(h,i)||"constructor"==h&&(l||!c.call(t,h))||p.push(h);return p}},function(t,e,n){t.exports={create:n(44),clone:n(45),copy:n(46),identity:n(7),transpose:n(47),invert:n(48),adjoint:n(49),determinant:n(50),multiply:n(51),translate:n(52),scale:n(53),rotate:n(54),rotateX:n(55),rotateY:n(56),rotateZ:n(57),fromRotation:n(58),fromRotationTranslation:n(59),fromScaling:n(60),fromTranslation:n(61),fromXRotation:n(62),fromYRotation:n(63),fromZRotation:n(64),fromQuat:n(65),frustum:n(66),perspective:n(67),perspectiveFromFieldOfView:n(68),ortho:n(69),lookAt:n(70),str:n(71)}},function(t,e){t.exports=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e,n){"use strict";var r=n(73),o=n(74),i="array of arrays",c="array of typed arrays",u="flat array",a="typed array",s="ndarray";t.exports={identify:function(t){if(Array.isArray(t)&&Array.isArray(t[0]))return i;if(Array.isArray(t)&&r(t[0]))return c;if(Array.isArray(t))return u;if(o(t))return s;if(r(t))return a;throw new Error("geo-identify-position-format: Could not identify position format.")},ARRAY_OF_ARRAYS:i,ARRAY_OF_TYPED_ARRAYS:c,FLAT_ARRAY:u,TYPED_ARRAY:a,NDARRAY:s}},function(t,e,n){"use strict";var r=n(8),o=n(75);t.exports={convert:function(t,e,n){if(e=void 0===e?r.TYPED_ARRAY:e,-1===[r.FLAT_ARRAY,r.ARRAY_OF_ARRAYS,r.TYPED_ARRAY,r.ARRAY_OF_TYPED_ARRAYS,r.NDARRAY].indexOf(e))throw new Error("geo-convert-position-format: Unknown target format "+e);var i,c=r.identify(t);if(c===r.FLAT_ARRAY)i=new Float32Array(t);else if(c===r.TYPED_ARRAY)i=new Float32Array(t);else if(c===r.ARRAY_OF_ARRAYS){i=[];for(var u=0;u<t.length;u++)i.push.apply(i,t[u]);i=new Float32Array(i)}else if(c===r.ARRAY_OF_TYPED_ARRAYS){i=[];for(var u=0;u<t.length;u++)i.push.apply(i,t[u]);i=new Float32Array(i)}else{if(c!==r.NDARRAY)throw new Error("geo-convert-position-format: Could not convert from incoming format "+c);i=new Float32Array(t.data)}void 0===n&&(n=i.length%3==0?3:i.length%2==0?2:1);if(-1===[1,2,3].indexOf(n))throw new Error("geo-convert-position-format: Stride "+n+" not a valid stride - must be 1, 2, or 3");if(i.length%n!=0)throw new Error("geo-convert-position-format: Stride "+n+" incompatible with element count "+i.length);if(e===r.TYPED_ARRAY)return i;if(e===r.FLAT_ARRAY)return Array.prototype.slice.call(i);if(e===r.ARRAY_OF_ARRAYS){for(var a=[],u=0,s=0,f=i.length/n;s<f;s++){for(var l=[],p=0;p<n;p++)l.push(i[u++]);a.push(l)}return a}if(e===r.ARRAY_OF_TYPED_ARRAYS){for(var a=[],u=0,s=0,f=i.length/n;s<f;s++){for(var l=[],p=0;p<n;p++)l.push(i[u++]);a.push(new Float32Array(l))}return a}if(e===r.NDARRAY)return o(i);throw new Error("geo-convert-position-format: Could not convert to target format "+e)},FLAT_ARRAY:r.FLAT_ARRAY,ARRAY_OF_ARRAYS:r.ARRAY_OF_ARRAYS,TYPED_ARRAY:r.TYPED_ARRAY,ARRAY_OF_TYPED_ARRAYS:r.ARRAY_OF_TYPED_ARRAYS,NDARRAY:r.NDARRAY}},function(t,e){t.exports=1e-6},function(t,e){t.exports=function(){var t=new Float32Array(3);return t[0]=0,t[1]=0,t[2]=0,t}},function(t,e){t.exports=function(t,e,n){var r=new Float32Array(3);return r[0]=t,r[1]=e,r[2]=n,r}},function(t,e){t.exports=function(t,e){var n=e[0],r=e[1],o=e[2],i=n*n+r*r+o*o;i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i);return t}},function(t,e){t.exports=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}},function(t,e){t.exports=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return Math.sqrt(n*n+r*r+o*o)}},function(t,e){t.exports=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return n*n+r*r+o*o}},function(t,e){t.exports=function(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}},function(t,e){t.exports=function(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);!function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(114)),e.fbo=function(t,e){return r.regl.framebuffer({width:t,height:void 0!==e?e:t,colorFormat:"rgba",colorType:"uint8"})},e.getSmallestPOTSize=function(t){for(var e=1;e*e<t;)e*=2;return e}},function(t,e,n){"use strict";var r=n(29),o=n(43),i=n(6),c=n(72),u=n(9);t.exports=function(t,e){e=r(e=e||{},{center:[0,0,0]}),t=u.convert(t,u.ARRAY_OF_ARRAYS);var n=o(t),a=[-.5*(n[0][0]+n[1][0])+e.center[0],-.5*(n[0][1]+n[1][1])+e.center[1],-.5*(n[0][2]+n[1][2])+e.center[2]],s=i.create();return i.translate(s,s,a),c(t,s)}},function(t,e,n){var r=n(6);t.exports=function(t,e){var n=this,o=(e=e||{}).speed||.005,i=e.container||window,c=e.onRotate||function(){},u=e.drag||0,a=e.invert||!1;a=a?-1:1,n.rotation=r.create();var s={x:0,y:0,dx:0,dy:0,dz:0,down:!1};n.rotate=function(t,e){var i=r.create();r.rotateY(i,i,t*o),r.rotateX(i,i,e*o),r.multiply(n.rotation,i,n.rotation),c()},n.spin=function(t,e){s.dx=t,s.dy=e},function t(){if(requestAnimationFrame(t),s.down)return s.dx=0,void(s.dy=0);Math.abs(s.dx*o)<1e-4&&(s.dx=0),Math.abs(s.dy*o)<1e-4&&(s.dy=0),0===s.dx&&0===s.dy||(s.dx-=s.dx*u,s.dy-=s.dy*u,n.rotate(s.dx,s.dy))}(),t.addEventListener("mousedown",function(t){s.x=t.clientX,s.y=t.clientY,s.dx=0,s.dy=0,s.down=!0,t.preventDefault()}),i.addEventListener("mouseup",function(t){s.down=!1}),i.addEventListener("mousemove",function(t){s.down&&(s.dx=a*(t.clientX-s.x),s.dy=a*(t.clientY-s.y),s.x=t.clientX,s.y=t.clientY,n.rotate(s.dx,s.dy))})}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function c(t){try{a(r.next(t))}catch(t){i(t)}}function u(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(c,u)}a((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var n,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(t,c)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(e,"__esModule",{value:!0}),n(26);var i=n(1),c=n(27),u=n(112),a=n(113);!function(){r(this,void 0,void 0,function(){var t,e,n,r,s,f,l,p,v,h,d,y,m,x,b,A,g;return o(this,function(o){switch(o.label){case 0:return[4,fetch("resources/pirate_ship.json")];case 1:return[4,o.sent().json()];case 2:return t=o.sent(),e=t.positions.length/3,t.colors=t.colors.Col,n=u.createSampleCollection(t,.1),[4,a.renderSamples(t,n.all,{near:.1,far:7,fov:.4*Math.PI,sampleSize:4,contrast:1})];case 3:for(r=o.sent(),l=0;l<r.length;l++)n.all[l].value=r[l];for(s=new Float32Array(e),f=i.vec3.create(),l=0;l<e;l++){for(p=n.perVertex[l],v=p.length,i.vec3.copyFromOffset(f,t.positions,3*l),h=0,d=0,y=[],m=[],A=0;A<v;A++)h=i.vec3.dist(f,p[A].position),d+=h,y.push(h),m.push(p[A].value);for(x=0,b=0,A=0;A<v;A++)g=1-y[A]/d,b+=g,x+=m[A]*g;x/=b,s[l]=1-x}return c.renderModel(t,s),[2]}})})}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);r.vec3.UP=r.vec3.fromValues(0,1,0),r.vec3.DOWN=r.vec3.fromValues(0,-1,0),r.vec3.LEFT=r.vec3.fromValues(-1,0,0),r.vec3.RIGHT=r.vec3.fromValues(1,0,0),r.vec3.ONE=r.vec3.fromValues(1,1,1),r.vec3.ZERO=r.vec3.fromValues(0,0,0),r.vec3.copyFromOffset=function(t,e,n){return t[0]=e[n+0],t[1]=e[n+1],t[2]=e[n+2],t}},function(t,e,n){"use strict";n.r(e),n.d(e,"renderModel",function(){return s});var r=n(0),o=n(1),i=n(23),c=n.n(i),u=n(24),a=n.n(u);function s(t,e){const n=document.getElementsByTagName("canvas")[0],i=c()(t.positions,{center:[0,-.5,0]});var u=new a.a(n,{onRotate:l,drag:.01});const s=Object(r.regl)({vert:"\n\t\t\tprecision highp float;\n\t\t\tattribute vec3 position;\n\t\t\tattribute vec3 color;\n\t\t\tattribute float occlusion;\n\t\t\tuniform mat4 model, view, projection;\n\t\t\tvarying float vOcclusion;\n\t\t\tvarying vec3 vColor;\n\n\t\t\tvoid main() {\n\t\t\t\tgl_Position = projection * view * model * vec4(position, 1);\n\t\t\t\tvOcclusion = occlusion;\n\t\t\t\tvColor = color;\n\t\t\t}\n\t\t",frag:"\n\t\t\tprecision highp float;\n\t\t\tvarying float vOcclusion;\n\t\t\tvarying vec3 vColor;\n\n\t\t\tvoid main() {\n\t\t\t\tgl_FragColor = vec4(vColor * vec3(vOcclusion), 1.0);\n\t\t\t}\n\t\t",attributes:{position:r.regl.buffer(i),color:r.regl.buffer(t.colors),occlusion:e},uniforms:{model:r.regl.prop("model"),view:r.regl.prop("view"),projection:r.regl.prop("projection")},viewport:r.regl.prop("viewport"),elements:r.regl.elements(t.indices),cull:{enable:!0,face:"back"}});let f=32;function l(){n.width=n.clientWidth,n.height=n.clientHeight;const t=u.rotation,e=o.mat4.lookAt([],[0,0,f],[0,0,0],[0,1,0]),i=o.mat4.perspective([],Math.PI/4,n.width/n.height,.1,1e3);r.regl.clear({color:[.3,.3,.3,1],depth:1}),s({model:t,view:e,projection:i,viewport:{x:0,y:0,width:n.width,height:n.height}})}window.addEventListener("wheel",function(t){t.deltaY<0?f*=.9:t.deltaY>0&&(f*=1.1),f=Math.max(2,Math.min(64,f)),l()}),u.spin(15,0)}},function(t,e){t.exports=createREGL},function(t,e,n){var r=n(30),o=n(4);var i,c,u=(i=r,c=function t(e,n){return void 0===e?n:r(e,n,t)},o(function(t){var e=t[0];return null==e?e:(t.push(c),i.apply(void 0,t))}));t.exports=u},function(t,e,n){var r=n(31),o=n(32),i=n(33),c=n(2),u=n(3),a=n(36),s=n(38),f=n(39),l=n(41);var p=9007199254740991;var v,h=(v="length",function(t){return null==t?void 0:t[v]});function d(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=p}(h(t))}var y=i(function t(e,n,i,p,v){if(y=typeof(h=e),!h||"object"!=y&&"function"!=y)return e;var h,y,m=d(n)&&(u(n)||s(n)),x=m?void 0:f(n);return o(x||n,function(o,f){if(x&&(o=n[f=o]),function(t){return!!t&&"object"==typeof t}(o))p||(p=[]),v||(v=[]),function(t,e,n,o,i,f,p){for(var v=f.length,h=e[n];v--;)if(f[v]==h)return void(t[n]=p[v]);var y=t[n],m=i?i(y,h,n,t,e):void 0,x=void 0===m;x&&(m=h,d(h)&&(u(h)||s(h))?m=u(y)?y:d(y)?r(y):[]:a(h)||c(h)?m=c(y)?l(y):a(y)?y:{}:x=!1),f.push(h),p.push(m),x?t[n]=o(m,h,i,f,p):(m==m?m!==y:y==y)&&(t[n]=m)}(e,n,f,t,i,p,v);else{var h=e[f],y=i?i(h,o,f,e,n):void 0,b=void 0===y;b&&(y=o),void 0===y&&(!m||f in e)||!b&&(y==y?y===h:h!=h)||(e[f]=y)}}),e});t.exports=y},function(t,e){t.exports=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}},function(t,e){t.exports=function(t,e){for(var n=-1,r=t.length;++n<r&&!1!==e(t[n],n,t););return t}},function(t,e,n){var r=n(34),o=n(35),i=n(4);t.exports=function(t){return i(function(e,n){var i=-1,c=null==e?0:n.length,u=c>2?n[c-2]:void 0,a=c>2?n[2]:void 0,s=c>1?n[c-1]:void 0;for("function"==typeof u?(u=r(u,s,5),c-=2):c-=(u="function"==typeof s?s:void 0)?1:0,a&&o(n[0],n[1],a)&&(u=c<3?void 0:u,c=1);++i<c;){var f=n[i];f&&t(e,f,u)}return e})}},function(t,e){function n(t){return t}t.exports=function(t,e,r){if("function"!=typeof t)return n;if(void 0===e)return t;switch(r){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,o){return t.call(e,n,r,o)};case 4:return function(n,r,o,i){return t.call(e,n,r,o,i)};case 5:return function(n,r,o,i,c){return t.call(e,n,r,o,i,c)}}return function(){return t.apply(e,arguments)}}},function(t,e){var n=/^\d+$/,r=9007199254740991;var o,i=(o="length",function(t){return null==t?void 0:t[o]});function c(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}(i(t))}t.exports=function(t,e,o){if(!function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}(o))return!1;var i=typeof e;if("number"==i?c(o)&&function(t,e){return t="number"==typeof t||n.test(t)?+t:-1,e=null==e?r:e,t>-1&&t%1==0&&t<e}(e,o.length):"string"==i&&e in o){var u=o[e];return t==t?t===u:u!=u}return!1}},function(t,e,n){var r=n(37),o=n(2),i=n(5),c="[object Object]";var u=Object.prototype,a=u.hasOwnProperty,s=u.toString;t.exports=function(t){var e,n;return!(!function(t){return!!t&&"object"==typeof t}(t)||s.call(t)!=c||o(t)||!(a.call(t,"constructor")||"function"!=typeof(e=t.constructor)||e instanceof e))&&(r(t,function(t,e){n=e},i),void 0===n||a.call(t,n))}},function(t,e){var n,r=function(t,e,r){for(var o=-1,i=Object(t),c=r(t),u=c.length;u--;){var a=c[n?u:++o];if(!1===e(i[a],a,i))break}return t};t.exports=r},function(t,e){var n=9007199254740991,r={};r["[object Float32Array]"]=r["[object Float64Array]"]=r["[object Int8Array]"]=r["[object Int16Array]"]=r["[object Int32Array]"]=r["[object Uint8Array]"]=r["[object Uint8ClampedArray]"]=r["[object Uint16Array]"]=r["[object Uint32Array]"]=!0,r["[object Arguments]"]=r["[object Array]"]=r["[object ArrayBuffer]"]=r["[object Boolean]"]=r["[object DataView]"]=r["[object Date]"]=r["[object Error]"]=r["[object Function]"]=r["[object Map]"]=r["[object Number]"]=r["[object Object]"]=r["[object RegExp]"]=r["[object Set]"]=r["[object String]"]=r["[object WeakMap]"]=!1;var o=Object.prototype.toString;t.exports=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}(t.length)&&!!r[o.call(t)]}},function(t,e,n){var r=n(40),o=n(2),i=n(3),c=/^\d+$/,u=Object.prototype.hasOwnProperty,a=r(Object,"keys"),s=9007199254740991;var f,l=(f="length",function(t){return null==t?void 0:t[f]});function p(t,e){return t="number"==typeof t||c.test(t)?+t:-1,e=null==e?s:e,t>-1&&t%1==0&&t<e}function v(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=s}function h(t){for(var e=function(t){if(null==t)return[];d(t)||(t=Object(t));var e=t.length;e=e&&v(e)&&(i(t)||o(t))&&e||0;var n=t.constructor,r=-1,c="function"==typeof n&&n.prototype===t,a=Array(e),s=e>0;for(;++r<e;)a[r]=r+"";for(var f in t)s&&p(f,e)||"constructor"==f&&(c||!u.call(t,f))||a.push(f);return a}(t),n=e.length,r=n&&t.length,c=!!r&&v(r)&&(i(t)||o(t)),a=-1,s=[];++a<n;){var f=e[a];(c&&p(f,r)||u.call(t,f))&&s.push(f)}return s}function d(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var y=a?function(t){var e,n=null==t?void 0:t.constructor;return"function"==typeof n&&n.prototype===t||"function"!=typeof t&&(null!=(e=t)&&v(l(e)))?h(t):d(t)?a(t):[]}:h;t.exports=y},function(t,e){var n="[object Function]",r=/^\[object .+?Constructor\]$/;var o=Object.prototype,i=Function.prototype.toString,c=o.hasOwnProperty,u=o.toString,a=RegExp("^"+i.call(c).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t,e){var o=null==t?void 0:t[e];return function(t){return null!=t&&(function(t){return function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}(t)&&u.call(t)==n}(t)?a.test(i.call(t)):function(t){return!!t&&"object"==typeof t}(t)&&r.test(t))}(o)?o:void 0}},function(t,e,n){var r=n(42),o=n(5);t.exports=function(t){return r(t,o(t))}},function(t,e){t.exports=function(t,e,n){n||(n={});for(var r=-1,o=e.length;++r<o;){var i=e[r];n[i]=t[i]}return n}},function(t,e){t.exports=function(t){if(0===t.length)return null;for(var e=t[0].length,n=new Array(e),r=new Array(e),o=0;o<e;o++)n[o]=1/0,r[o]=-1/0;return t.forEach(function(t){for(var o=0;o<e;o++)r[o]=t[o]>r[o]?t[o]:r[o],n[o]=t[o]<n[o]?t[o]:n[o]}),[n,r]}},function(t,e){t.exports=function(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t){var e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},function(t,e){t.exports=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},function(t,e){t.exports=function(t,e){if(t===e){var n=e[1],r=e[2],o=e[3],i=e[6],c=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=o,t[13]=c,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}},function(t,e){t.exports=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],c=e[4],u=e[5],a=e[6],s=e[7],f=e[8],l=e[9],p=e[10],v=e[11],h=e[12],d=e[13],y=e[14],m=e[15],x=n*u-r*c,b=n*a-o*c,A=n*s-i*c,g=r*a-o*u,S=r*s-i*u,w=o*s-i*a,j=f*d-l*h,M=f*y-p*h,_=f*m-v*h,R=l*y-p*d,z=l*m-v*d,P=p*m-v*y,C=x*P-b*z+A*R+g*_-S*M+w*j;if(!C)return null;return C=1/C,t[0]=(u*P-a*z+s*R)*C,t[1]=(o*z-r*P-i*R)*C,t[2]=(d*w-y*S+m*g)*C,t[3]=(p*S-l*w-v*g)*C,t[4]=(a*_-c*P-s*M)*C,t[5]=(n*P-o*_+i*M)*C,t[6]=(y*A-h*w-m*b)*C,t[7]=(f*w-p*A+v*b)*C,t[8]=(c*z-u*_+s*j)*C,t[9]=(r*_-n*z-i*j)*C,t[10]=(h*S-d*A+m*x)*C,t[11]=(l*A-f*S-v*x)*C,t[12]=(u*M-c*R-a*j)*C,t[13]=(n*R-r*M+o*j)*C,t[14]=(d*b-h*g-y*x)*C,t[15]=(f*g-l*b+p*x)*C,t}},function(t,e){t.exports=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],c=e[4],u=e[5],a=e[6],s=e[7],f=e[8],l=e[9],p=e[10],v=e[11],h=e[12],d=e[13],y=e[14],m=e[15];return t[0]=u*(p*m-v*y)-l*(a*m-s*y)+d*(a*v-s*p),t[1]=-(r*(p*m-v*y)-l*(o*m-i*y)+d*(o*v-i*p)),t[2]=r*(a*m-s*y)-u*(o*m-i*y)+d*(o*s-i*a),t[3]=-(r*(a*v-s*p)-u*(o*v-i*p)+l*(o*s-i*a)),t[4]=-(c*(p*m-v*y)-f*(a*m-s*y)+h*(a*v-s*p)),t[5]=n*(p*m-v*y)-f*(o*m-i*y)+h*(o*v-i*p),t[6]=-(n*(a*m-s*y)-c*(o*m-i*y)+h*(o*s-i*a)),t[7]=n*(a*v-s*p)-c*(o*v-i*p)+f*(o*s-i*a),t[8]=c*(l*m-v*d)-f*(u*m-s*d)+h*(u*v-s*l),t[9]=-(n*(l*m-v*d)-f*(r*m-i*d)+h*(r*v-i*l)),t[10]=n*(u*m-s*d)-c*(r*m-i*d)+h*(r*s-i*u),t[11]=-(n*(u*v-s*l)-c*(r*v-i*l)+f*(r*s-i*u)),t[12]=-(c*(l*y-p*d)-f*(u*y-a*d)+h*(u*p-a*l)),t[13]=n*(l*y-p*d)-f*(r*y-o*d)+h*(r*p-o*l),t[14]=-(n*(u*y-a*d)-c*(r*y-o*d)+h*(r*a-o*u)),t[15]=n*(u*p-a*l)-c*(r*p-o*l)+f*(r*a-o*u),t}},function(t,e){t.exports=function(t){var e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],c=t[5],u=t[6],a=t[7],s=t[8],f=t[9],l=t[10],p=t[11],v=t[12],h=t[13],d=t[14],y=t[15];return(e*c-n*i)*(l*y-p*d)-(e*u-r*i)*(f*y-p*h)+(e*a-o*i)*(f*d-l*h)+(n*u-r*c)*(s*y-p*v)-(n*a-o*c)*(s*d-l*v)+(r*a-o*u)*(s*h-f*v)}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1],i=e[2],c=e[3],u=e[4],a=e[5],s=e[6],f=e[7],l=e[8],p=e[9],v=e[10],h=e[11],d=e[12],y=e[13],m=e[14],x=e[15],b=n[0],A=n[1],g=n[2],S=n[3];return t[0]=b*r+A*u+g*l+S*d,t[1]=b*o+A*a+g*p+S*y,t[2]=b*i+A*s+g*v+S*m,t[3]=b*c+A*f+g*h+S*x,b=n[4],A=n[5],g=n[6],S=n[7],t[4]=b*r+A*u+g*l+S*d,t[5]=b*o+A*a+g*p+S*y,t[6]=b*i+A*s+g*v+S*m,t[7]=b*c+A*f+g*h+S*x,b=n[8],A=n[9],g=n[10],S=n[11],t[8]=b*r+A*u+g*l+S*d,t[9]=b*o+A*a+g*p+S*y,t[10]=b*i+A*s+g*v+S*m,t[11]=b*c+A*f+g*h+S*x,b=n[12],A=n[13],g=n[14],S=n[15],t[12]=b*r+A*u+g*l+S*d,t[13]=b*o+A*a+g*p+S*y,t[14]=b*i+A*s+g*v+S*m,t[15]=b*c+A*f+g*h+S*x,t}},function(t,e){t.exports=function(t,e,n){var r,o,i,c,u,a,s,f,l,p,v,h,d=n[0],y=n[1],m=n[2];e===t?(t[12]=e[0]*d+e[4]*y+e[8]*m+e[12],t[13]=e[1]*d+e[5]*y+e[9]*m+e[13],t[14]=e[2]*d+e[6]*y+e[10]*m+e[14],t[15]=e[3]*d+e[7]*y+e[11]*m+e[15]):(r=e[0],o=e[1],i=e[2],c=e[3],u=e[4],a=e[5],s=e[6],f=e[7],l=e[8],p=e[9],v=e[10],h=e[11],t[0]=r,t[1]=o,t[2]=i,t[3]=c,t[4]=u,t[5]=a,t[6]=s,t[7]=f,t[8]=l,t[9]=p,t[10]=v,t[11]=h,t[12]=r*d+u*y+l*m+e[12],t[13]=o*d+a*y+p*m+e[13],t[14]=i*d+s*y+v*m+e[14],t[15]=c*d+f*y+h*m+e[15]);return t}},function(t,e){t.exports=function(t,e,n){var r=n[0],o=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},function(t,e){t.exports=function(t,e,n,r){var o,i,c,u,a,s,f,l,p,v,h,d,y,m,x,b,A,g,S,w,j,M,_,R,z=r[0],P=r[1],C=r[2],F=Math.sqrt(z*z+P*P+C*C);if(Math.abs(F)<1e-6)return null;z*=F=1/F,P*=F,C*=F,o=Math.sin(n),i=Math.cos(n),c=1-i,u=e[0],a=e[1],s=e[2],f=e[3],l=e[4],p=e[5],v=e[6],h=e[7],d=e[8],y=e[9],m=e[10],x=e[11],b=z*z*c+i,A=P*z*c+C*o,g=C*z*c-P*o,S=z*P*c-C*o,w=P*P*c+i,j=C*P*c+z*o,M=z*C*c+P*o,_=P*C*c-z*o,R=C*C*c+i,t[0]=u*b+l*A+d*g,t[1]=a*b+p*A+y*g,t[2]=s*b+v*A+m*g,t[3]=f*b+h*A+x*g,t[4]=u*S+l*w+d*j,t[5]=a*S+p*w+y*j,t[6]=s*S+v*w+m*j,t[7]=f*S+h*w+x*j,t[8]=u*M+l*_+d*R,t[9]=a*M+p*_+y*R,t[10]=s*M+v*_+m*R,t[11]=f*M+h*_+x*R,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t}},function(t,e){t.exports=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[4],c=e[5],u=e[6],a=e[7],s=e[8],f=e[9],l=e[10],p=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[4]=i*o+s*r,t[5]=c*o+f*r,t[6]=u*o+l*r,t[7]=a*o+p*r,t[8]=s*o-i*r,t[9]=f*o-c*r,t[10]=l*o-u*r,t[11]=p*o-a*r,t}},function(t,e){t.exports=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[0],c=e[1],u=e[2],a=e[3],s=e[8],f=e[9],l=e[10],p=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=i*o-s*r,t[1]=c*o-f*r,t[2]=u*o-l*r,t[3]=a*o-p*r,t[8]=i*r+s*o,t[9]=c*r+f*o,t[10]=u*r+l*o,t[11]=a*r+p*o,t}},function(t,e){t.exports=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[0],c=e[1],u=e[2],a=e[3],s=e[4],f=e[5],l=e[6],p=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=i*o+s*r,t[1]=c*o+f*r,t[2]=u*o+l*r,t[3]=a*o+p*r,t[4]=s*o-i*r,t[5]=f*o-c*r,t[6]=l*o-u*r,t[7]=p*o-a*r,t}},function(t,e){t.exports=function(t,e,n){var r,o,i,c=n[0],u=n[1],a=n[2],s=Math.sqrt(c*c+u*u+a*a);if(Math.abs(s)<1e-6)return null;return c*=s=1/s,u*=s,a*=s,r=Math.sin(e),o=Math.cos(e),i=1-o,t[0]=c*c*i+o,t[1]=u*c*i+a*r,t[2]=a*c*i-u*r,t[3]=0,t[4]=c*u*i-a*r,t[5]=u*u*i+o,t[6]=a*u*i+c*r,t[7]=0,t[8]=c*a*i+u*r,t[9]=u*a*i-c*r,t[10]=a*a*i+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1],i=e[2],c=e[3],u=r+r,a=o+o,s=i+i,f=r*u,l=r*a,p=r*s,v=o*a,h=o*s,d=i*s,y=c*u,m=c*a,x=c*s;return t[0]=1-(v+d),t[1]=l+x,t[2]=p-m,t[3]=0,t[4]=l-x,t[5]=1-(f+d),t[6]=h+y,t[7]=0,t[8]=p+m,t[9]=h-y,t[10]=1-(f+v),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}},function(t,e){t.exports=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}},function(t,e){t.exports=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],c=n+n,u=r+r,a=o+o,s=n*c,f=r*c,l=r*u,p=o*c,v=o*u,h=o*a,d=i*c,y=i*u,m=i*a;return t[0]=1-l-h,t[1]=f+m,t[2]=p-y,t[3]=0,t[4]=f-m,t[5]=1-s-h,t[6]=v+d,t[7]=0,t[8]=p+y,t[9]=v-d,t[10]=1-s-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t,e,n,r,o,i,c){var u=1/(n-e),a=1/(o-r),s=1/(i-c);return t[0]=2*i*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*a,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(o+r)*a,t[10]=(c+i)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=c*i*2*s,t[15]=0,t}},function(t,e){t.exports=function(t,e,n,r,o){var i=1/Math.tan(e/2),c=1/(r-o);return t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(o+r)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*o*r*c,t[15]=0,t}},function(t,e){t.exports=function(t,e,n,r){var o=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),c=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),a=2/(c+u),s=2/(o+i);return t[0]=a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=-(c-u)*a*.5,t[9]=(o-i)*s*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}},function(t,e){t.exports=function(t,e,n,r,o,i,c){var u=1/(e-n),a=1/(r-o),s=1/(i-c);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*s,t[11]=0,t[12]=(e+n)*u,t[13]=(o+r)*a,t[14]=(c+i)*s,t[15]=1,t}},function(t,e,n){var r=n(7);t.exports=function(t,e,n,o){var i,c,u,a,s,f,l,p,v,h,d=e[0],y=e[1],m=e[2],x=o[0],b=o[1],A=o[2],g=n[0],S=n[1],w=n[2];if(Math.abs(d-g)<1e-6&&Math.abs(y-S)<1e-6&&Math.abs(m-w)<1e-6)return r(t);l=d-g,p=y-S,v=m-w,h=1/Math.sqrt(l*l+p*p+v*v),i=b*(v*=h)-A*(p*=h),c=A*(l*=h)-x*v,u=x*p-b*l,(h=Math.sqrt(i*i+c*c+u*u))?(i*=h=1/h,c*=h,u*=h):(i=0,c=0,u=0);a=p*u-v*c,s=v*i-l*u,f=l*c-p*i,(h=Math.sqrt(a*a+s*s+f*f))?(a*=h=1/h,s*=h,f*=h):(a=0,s=0,f=0);return t[0]=i,t[1]=a,t[2]=l,t[3]=0,t[4]=c,t[5]=s,t[6]=p,t[7]=0,t[8]=u,t[9]=f,t[10]=v,t[11]=0,t[12]=-(i*d+c*y+u*m),t[13]=-(a*d+s*y+f*m),t[14]=-(l*d+p*y+v*m),t[15]=1,t}},function(t,e){t.exports=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}},function(t,e,n){"use strict";var r=n(8),o=n(9),i=n(78);t.exports=function(t,e){for(var n=r.identify(t),c=o.convert(t,r.ARRAY_OF_ARRAYS,3),u=0;u<c.length;u++)i.transformMat4(c[u],c[u],e);return c=o.convert(c,n,3)}},function(t,e){t.exports=o,o.strict=i,o.loose=c;var n=Object.prototype.toString,r={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0};function o(t){return i(t)||c(t)}function i(t){return t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array}function c(t){return r[n.call(t)]}},function(t,e){t.exports=function(t){return!!t&&(!!t.dtype&&new RegExp("function View[0-9]+d(:?"+t.dtype+")+").test(String(t.constructor)))}},function(t,e,n){var r=n(76),o=n(77),i="undefined"!=typeof Float64Array;function c(t,e){return t[0]-e[0]}function u(){var t,e=this.stride,n=new Array(e.length);for(t=0;t<n.length;++t)n[t]=[Math.abs(e[t]),t];n.sort(c);var r=new Array(n.length);for(t=0;t<r.length;++t)r[t]=n[t][1];return r}function a(t,e){var n=["View",e,"d",t].join("");e<0&&(n="View_Nil"+t);var o="generic"===t;if(-1===e){var i="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+t+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}";return new Function(i)()}if(0===e){i="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+t+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(o?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(o?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}";return new Function("TrivialArray",i)(s[t][0])}i=["'use strict'"];var c=r(e),a=c.map(function(t){return"i"+t}),f="this.offset+"+c.map(function(t){return"this.stride["+t+"]*i"+t}).join("+"),l=c.map(function(t){return"b"+t}).join(","),p=c.map(function(t){return"c"+t}).join(",");i.push("function "+n+"(a,"+l+","+p+",d){this.data=a","this.shape=["+l+"]","this.stride=["+p+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+t+"'","proto.dimension="+e),i.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+c.map(function(t){return"this.shape["+t+"]"}).join("*"),"}})"),1===e?i.push("proto.order=[0]"):(i.push("Object.defineProperty(proto,'order',{get:"),e<4?(i.push("function "+n+"_order(){"),2===e?i.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===e&&i.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):i.push("ORDER})")),i.push("proto.set=function "+n+"_set("+a.join(",")+",v){"),o?i.push("return this.data.set("+f+",v)}"):i.push("return this.data["+f+"]=v}"),i.push("proto.get=function "+n+"_get("+a.join(",")+"){"),o?i.push("return this.data.get("+f+")}"):i.push("return this.data["+f+"]}"),i.push("proto.index=function "+n+"_index(",a.join(),"){return "+f+"}"),i.push("proto.hi=function "+n+"_hi("+a.join(",")+"){return new "+n+"(this.data,"+c.map(function(t){return["(typeof i",t,"!=='number'||i",t,"<0)?this.shape[",t,"]:i",t,"|0"].join("")}).join(",")+","+c.map(function(t){return"this.stride["+t+"]"}).join(",")+",this.offset)}");var v=c.map(function(t){return"a"+t+"=this.shape["+t+"]"}),h=c.map(function(t){return"c"+t+"=this.stride["+t+"]"});i.push("proto.lo=function "+n+"_lo("+a.join(",")+"){var b=this.offset,d=0,"+v.join(",")+","+h.join(","));for(var d=0;d<e;++d)i.push("if(typeof i"+d+"==='number'&&i"+d+">=0){d=i"+d+"|0;b+=c"+d+"*d;a"+d+"-=d}");i.push("return new "+n+"(this.data,"+c.map(function(t){return"a"+t}).join(",")+","+c.map(function(t){return"c"+t}).join(",")+",b)}"),i.push("proto.step=function "+n+"_step("+a.join(",")+"){var "+c.map(function(t){return"a"+t+"=this.shape["+t+"]"}).join(",")+","+c.map(function(t){return"b"+t+"=this.stride["+t+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(d=0;d<e;++d)i.push("if(typeof i"+d+"==='number'){d=i"+d+"|0;if(d<0){c+=b"+d+"*(a"+d+"-1);a"+d+"=ceil(-a"+d+"/d)}else{a"+d+"=ceil(a"+d+"/d)}b"+d+"*=d}");i.push("return new "+n+"(this.data,"+c.map(function(t){return"a"+t}).join(",")+","+c.map(function(t){return"b"+t}).join(",")+",c)}");var y=new Array(e),m=new Array(e);for(d=0;d<e;++d)y[d]="a[i"+d+"]",m[d]="b[i"+d+"]";i.push("proto.transpose=function "+n+"_transpose("+a+"){"+a.map(function(t,e){return t+"=("+t+"===undefined?"+e+":"+t+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+y.join(",")+","+m.join(",")+",this.offset)}"),i.push("proto.pick=function "+n+"_pick("+a+"){var a=[],b=[],c=this.offset");for(d=0;d<e;++d)i.push("if(typeof i"+d+"==='number'&&i"+d+">=0){c=(c+this.stride["+d+"]*i"+d+")|0}else{a.push(this.shape["+d+"]);b.push(this.stride["+d+"])}");return i.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),i.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+c.map(function(t){return"shape["+t+"]"}).join(",")+","+c.map(function(t){return"stride["+t+"]"}).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",i.join("\n"))(s[t],u)}var s={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=function(t,e,n,r){if(void 0===t)return(0,s.array[0])([]);"number"==typeof t&&(t=[t]),void 0===e&&(e=[t.length]);var c=e.length;if(void 0===n){n=new Array(c);for(var u=c-1,f=1;u>=0;--u)n[u]=f,f*=e[u]}if(void 0===r)for(r=0,u=0;u<c;++u)n[u]<0&&(r-=(e[u]-1)*n[u]);for(var l=function(t){if(o(t))return"buffer";if(i)switch(Object.prototype.toString.call(t)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(t)?"array":"generic"}(t),p=s[l];p.length<=c+1;)p.push(a(l,p.length-1));return(0,p[c+1])(t,e,n,r)}},function(t,e,n){"use strict";t.exports=function(t){for(var e=new Array(t),n=0;n<t;++n)e[n]=n;return e}},function(t,e){function n(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&(n(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&n(t.slice(0,0))}(t)||!!t._isBuffer)}},function(t,e,n){t.exports={EPSILON:n(10),create:n(11),clone:n(79),angle:n(80),fromValues:n(12),copy:n(81),set:n(82),equals:n(83),exactEquals:n(84),add:n(85),subtract:n(15),sub:n(86),multiply:n(16),mul:n(87),divide:n(17),div:n(88),min:n(89),max:n(90),floor:n(91),ceil:n(92),round:n(93),scale:n(94),scaleAndAdd:n(95),distance:n(18),dist:n(96),squaredDistance:n(19),sqrDist:n(97),length:n(20),len:n(98),squaredLength:n(21),sqrLen:n(99),negate:n(100),inverse:n(101),normalize:n(13),dot:n(14),cross:n(102),lerp:n(103),random:n(104),transformMat4:n(105),transformMat3:n(106),transformQuat:n(107),rotateX:n(108),rotateY:n(109),rotateZ:n(110),forEach:n(111)}},function(t,e){t.exports=function(t){var e=new Float32Array(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},function(t,e,n){t.exports=function(t,e){var n=r(t[0],t[1],t[2]),c=r(e[0],e[1],e[2]);o(n,n),o(c,c);var u=i(n,c);return u>1?0:Math.acos(u)};var r=n(12),o=n(13),i=n(14)},function(t,e){t.exports=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},function(t,e){t.exports=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}},function(t,e,n){t.exports=function(t,e){var n=t[0],o=t[1],i=t[2],c=e[0],u=e[1],a=e[2];return Math.abs(n-c)<=r*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(o-u)<=r*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(i-a)<=r*Math.max(1,Math.abs(i),Math.abs(a))};var r=n(10)},function(t,e){t.exports=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}},function(t,e,n){t.exports=n(15)},function(t,e,n){t.exports=n(16)},function(t,e,n){t.exports=n(17)},function(t,e){t.exports=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}},function(t,e){t.exports=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}},function(t,e){t.exports=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}},function(t,e){t.exports=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}},function(t,e){t.exports=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}},function(t,e){t.exports=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}},function(t,e,n){t.exports=n(18)},function(t,e,n){t.exports=n(19)},function(t,e,n){t.exports=n(20)},function(t,e,n){t.exports=n(21)},function(t,e){t.exports=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}},function(t,e){t.exports=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1],i=e[2],c=n[0],u=n[1],a=n[2];return t[0]=o*a-i*u,t[1]=i*c-r*a,t[2]=r*u-o*c,t}},function(t,e){t.exports=function(t,e,n,r){var o=e[0],i=e[1],c=e[2];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t[2]=c+r*(n[2]-c),t}},function(t,e){t.exports=function(t,e){e=e||1;var n=2*Math.random()*Math.PI,r=2*Math.random()-1,o=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=r*e,t}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1],i=e[2],c=n[3]*r+n[7]*o+n[11]*i+n[15];return c=c||1,t[0]=(n[0]*r+n[4]*o+n[8]*i+n[12])/c,t[1]=(n[1]*r+n[5]*o+n[9]*i+n[13])/c,t[2]=(n[2]*r+n[6]*o+n[10]*i+n[14])/c,t}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1],i=e[2];return t[0]=r*n[0]+o*n[3]+i*n[6],t[1]=r*n[1]+o*n[4]+i*n[7],t[2]=r*n[2]+o*n[5]+i*n[8],t}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1],i=e[2],c=n[0],u=n[1],a=n[2],s=n[3],f=s*r+u*i-a*o,l=s*o+a*r-c*i,p=s*i+c*o-u*r,v=-c*r-u*o-a*i;return t[0]=f*s+v*-c+l*-a-p*-u,t[1]=l*s+v*-u+p*-c-f*-a,t[2]=p*s+v*-a+f*-u-l*-c,t}},function(t,e){t.exports=function(t,e,n,r){var o=n[1],i=n[2],c=e[1]-o,u=e[2]-i,a=Math.sin(r),s=Math.cos(r);return t[0]=e[0],t[1]=o+c*s-u*a,t[2]=i+c*a+u*s,t}},function(t,e){t.exports=function(t,e,n,r){var o=n[0],i=n[2],c=e[0]-o,u=e[2]-i,a=Math.sin(r),s=Math.cos(r);return t[0]=o+u*a+c*s,t[1]=e[1],t[2]=i+u*s-c*a,t}},function(t,e){t.exports=function(t,e,n,r){var o=n[0],i=n[1],c=e[0]-o,u=e[1]-i,a=Math.sin(r),s=Math.cos(r);return t[0]=o+c*s-u*a,t[1]=i+c*a+u*s,t[2]=e[2],t}},function(t,e,n){t.exports=function(t,e,n,o,i,c){var u,a;e||(e=3);n||(n=0);a=o?Math.min(o*e+n,t.length):t.length;for(u=n;u<a;u+=e)r[0]=t[u],r[1]=t[u+1],r[2]=t[u+2],i(r,r,c),t[u]=r[0],t[u+1]=r[1],t[u+2]=r[2];return t};var r=n(11)()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);e.createSampleCollection=function(t,e){var n=1-(e=Math.max(Math.min(e||0,1),0)),o=t.positions,i=t.normals,c=t.indices,u=o.length/3,a=c.length/3,s={perVertex:Array.from({length:u}).map(function(t){return[]}),all:[]};if(!o||!i||!c)return s;for(var f,l=[r.vec3.create(),r.vec3.create(),r.vec3.create()],p=[r.vec3.create(),r.vec3.create(),r.vec3.create()],v=r.vec3.create(),h=r.vec3.create(),d=r.vec3.create(),y=0;y<a;y++){for(r.vec3.copyFromOffset(d,c,3*y),f=0;f<3;f++)r.vec3.copyFromOffset(l[f],o,3*d[f]),r.vec3.copyFromOffset(p[f],i,3*d[f]);for(r.vec3.add(v,l[0],l[1]),r.vec3.add(v,v,l[2]),r.vec3.scale(v,v,1/3),r.vec3.add(h,p[0],p[1]),r.vec3.add(h,h,p[2]),r.vec3.normalize(h,h),f=0;f<3;f++){var m={position:r.vec3.create(),normal:r.vec3.create()};r.vec3.scale(m.position,l[f],n),r.vec3.scaleAndAdd(m.position,m.position,v,e),r.vec3.scale(m.normal,p[f],n),r.vec3.scaleAndAdd(m.normal,m.normal,h,e),r.vec3.normalize(m.normal,m.normal),s.perVertex[d[0]].push(m),s.perVertex[d[1]].push(m),s.perVertex[d[2]].push(m),s.all.push(m)}}return s}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function c(t){try{a(r.next(t))}catch(t){i(t)}}function u(t){try{a(r.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(c,u)}a((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var n,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(t,c)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),c=n(0),u=n(22),a=n(115),s=n(120);e.renderSamples=function(t,e,n){return r(this,void 0,void 0,function(){var r,f,l,p,v,h,d,y,m,x,b,A,g,S,w,j;return o(this,function(o){for(n=Object.assign({near:.2,far:7,fov:.45*Math.PI,sampleSize:8,contrast:1},n||{}),2048,r=u.fbo(2048),f=e.length,l=Math.floor(2048/n.sampleSize),p=Math.pow(2048/n.sampleSize,2),v=Math.ceil(f/p),h={viewport:{x:0,y:0,width:n.sampleSize,height:n.sampleSize},model:i.mat4.create(),view:i.mat4.create(),projection:i.mat4.perspective(i.mat4.create(),n.fov,1,n.near,n.far),positions:c.regl.buffer(t.positions),indices:c.regl.elements(t.indices),nearPlane:n.near,farPlane:n.far,contrast:n.contrast,framebuffer:r},d=i.vec3.create(),y=new Float32Array(f),m=0,x=f,b=0;b<v;){for(c.regl.clear({color:[0,0,0,0],depth:1,framebuffer:r}),A=Math.min(x,p),g=m;g<m+A;)S=e[g],i.vec3.add(d,S.position,S.normal),i.mat4.lookAt(h.view,S.position,d,i.vec3.UP),h.viewport.x=g%l*n.sampleSize,h.viewport.y=Math.floor(g/l)*n.sampleSize,s.renderDepth(h),g++;for(w=a.reduceSamples(r,n.sampleSize,A,n.contrast),j=0;j<A;j++)y[m+j]=w[j];m+=A,x-=A,b++}return r.destroy(),[2,y]})})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.waitForNextFrame=function(){return new Promise(function(t){requestAnimationFrame(t)})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(22),i={2:n(116),4:n(117),8:n(118)};e.reduceSamples=function(t,e,c,u){var a,s=t.width;if(s!==t.height||(a=s,Math.log2(a)%1!=0))throw new Error("Invalid dimensions of the source!");var f=i[e];if(!f)throw new Error("Invalid sampleSize, no matching shader found!");var l=s/e,p=o.fbo(l),v=new Float32Array(c);return p.use(function(e){r.regl({vert:n(119),frag:f,attributes:{position:[-1,-1,1,-1,1,1,-1,-1,1,1,-1,1]},uniforms:{contrast:u,source:t,size:[l,l]},count:6})();for(var o,i,a=r.regl.read(),s=0;s<c;s++)o=s%l,i=Math.floor(s/l)*l+o,v[s]=a[4*i]/255}),p.destroy(),v}},function(t,e){t.exports="precision highp float;\n\nvec4 sumCorners(sampler2D tex, vec2 minCellUV, vec2 cellSizeUV) {\n\treturn  texture2D(tex, minCellUV + cellSizeUV * vec2(0, 0)) +\n\t\t\ttexture2D(tex, minCellUV + cellSizeUV * vec2(1, 0)) +\n\t\t\ttexture2D(tex, minCellUV + cellSizeUV * vec2(1, 1)) +\n\t\t\ttexture2D(tex, minCellUV + cellSizeUV * vec2(0, 1));\n}\n\nprecision highp float;\n\nfloat colorToFloat(const vec4 value)\n{\n  const vec4 bitSh = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n  return(dot(value, bitSh));\n}\n\nprecision highp float;\n#define GLSLIFY 1\nuniform sampler2D source;\nuniform vec2 size;\nuniform float contrast;\n\nvoid main() {\n\tvec2 pixelCenter = gl_FragCoord.xy / size;\n\tvec2 pixelSize = vec2(1) / size;\n\tvec2 sourcePixelSize = pixelSize * 0.5;\n\n\tvec2 startUV = pixelCenter - pixelSize * 0.5 + sourcePixelSize * 0.5;\n\tfloat ao = sumCorners(source, startUV, sourcePixelSize).r / 4.0;\n\n\tgl_FragColor = vec4(pow(ao, contrast), 0, 0, 1);\n}\n"},function(t,e){t.exports="precision highp float;\n\nvec4 sumCorners(sampler2D tex, vec2 minCellUV, vec2 cellSizeUV) {\n\treturn  texture2D(tex, minCellUV + cellSizeUV * vec2(0, 0)) +\n\t\t\ttexture2D(tex, minCellUV + cellSizeUV * vec2(1, 0)) +\n\t\t\ttexture2D(tex, minCellUV + cellSizeUV * vec2(1, 1)) +\n\t\t\ttexture2D(tex, minCellUV + cellSizeUV * vec2(0, 1));\n}\n\nprecision highp float;\n\nfloat colorToFloat(const vec4 value)\n{\n  const vec4 bitSh = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n  return(dot(value, bitSh));\n}\n\nprecision highp float;\n#define GLSLIFY 1\nuniform sampler2D source;\nuniform vec2 size;\nuniform float contrast;\n\nvoid main() {\n\tvec2 pixelCenter = gl_FragCoord.xy / size;\n\tvec2 pixelSize = vec2(1) / size;\n\tvec2 sourcePixelSize = pixelSize * 0.25;\n\tvec2 sourceCellSize = sourcePixelSize * 2.0;\n\n\tvec2 startUV = pixelCenter - pixelSize * 0.5 + sourcePixelSize * 0.5;\n\n\tfloat ao = \t(sumCorners(source, startUV + sourceCellSize * vec2(0, 0), sourcePixelSize) +\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(1, 0), sourcePixelSize) +\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(1, 1), sourcePixelSize) +\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(0, 1), sourcePixelSize)).r / 16.0;\n\n\tgl_FragColor = vec4(pow(ao, contrast), 0, 0, 1);\n}\n"},function(t,e){t.exports="precision highp float;\n\nvec4 sumCorners(sampler2D tex, vec2 minCellUV, vec2 cellSizeUV) {\n\treturn  texture2D(tex, minCellUV + cellSizeUV * vec2(0, 0)) +\n\t\t\ttexture2D(tex, minCellUV + cellSizeUV * vec2(1, 0)) +\n\t\t\ttexture2D(tex, minCellUV + cellSizeUV * vec2(1, 1)) +\n\t\t\ttexture2D(tex, minCellUV + cellSizeUV * vec2(0, 1));\n}\n\nprecision highp float;\n\nfloat colorToFloat(const vec4 value)\n{\n  const vec4 bitSh = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n  return(dot(value, bitSh));\n}\n\nprecision highp float;\n#define GLSLIFY 1\nuniform sampler2D source;\nuniform vec2 size;\nuniform float contrast;\n\nvoid main() {\n\tvec2 pixelCenter = gl_FragCoord.xy / size;\n\tvec2 pixelSize = vec2(1) / size;\n\tvec2 sourcePixelSize = pixelSize * (1.0 / 8.0);\n\tvec2 sourceCellSize = sourcePixelSize * 2.0;\n\n\tvec2 startUV = pixelCenter - pixelSize * 0.5 + sourcePixelSize * 0.5;\n\n\tfloat ao = \t(sumCorners(source, startUV + sourceCellSize * vec2(0, 0), sourcePixelSize) +\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(1, 0), sourcePixelSize) +\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(2, 0), sourcePixelSize) +\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(3, 0), sourcePixelSize) +\n\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(0, 1), sourcePixelSize) +\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(1, 1), sourcePixelSize) +\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(2, 1), sourcePixelSize) +\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(3, 1), sourcePixelSize) +\n\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(0, 2), sourcePixelSize) +\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(1, 2), sourcePixelSize) +\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(2, 2), sourcePixelSize) +\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(3, 2), sourcePixelSize) +\n\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(0, 3), sourcePixelSize) +\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(1, 3), sourcePixelSize) +\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(2, 3), sourcePixelSize) +\n\t\t\t\tsumCorners(source, startUV + sourceCellSize * vec2(3, 3), sourcePixelSize)).r / 64.0;\n\n\tgl_FragColor = vec4(pow(ao, contrast), 0, 0, 1);\n}\n"},function(t,e){t.exports="precision highp float;\n#define GLSLIFY 1\nattribute vec2 position;\n\nvoid main() {\n\tgl_Position = vec4(position, 0, 1);\n}\n"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=r.propBinder(r.regl);e.renderDepth=r.regl({vert:n(121),frag:n(122),attributes:{position:o("positions")},uniforms:{model:o("model"),view:o("view"),projection:o("projection"),nearPlane:o("nearPlane"),farPlane:o("farPlane")},elements:o("indices"),viewport:o("viewport"),framebuffer:o("framebuffer"),cull:{enable:!1,face:"back"}})},function(t,e){t.exports="precision highp float;\n#define GLSLIFY 1\nattribute vec3 position;\nuniform mat4 model, view, projection;\nuniform float farPlane, nearPlane;\nvarying float occlusion;\n\nvoid main() {\n\tvec4 cs_position = view * model * vec4(position, 1);\n\tocclusion = 1.0 -  min(((-cs_position.z - nearPlane) / (farPlane - nearPlane)), 1.0);\n\tgl_Position = projection * cs_position;\n}\n"},function(t,e){t.exports="precision highp float;\n\nvec4 floatToColor(const float value)\n{\n  const vec4 bitSh = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n  const vec4 bitMsk = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n  vec4 res = fract(value * bitSh);\n  res -= res.xxyz * bitMsk;\n  return res;\n}\n\nprecision highp float;\n#define GLSLIFY 1\nvarying float occlusion;\n\nvoid main() {\n\tgl_FragColor = vec4(occlusion);\n}\n"}]);